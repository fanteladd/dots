#!/bin/sh

filename=$1
name="$(basename "$filename" .md)"
target="$(dirname "${filename}")"
outputFile="$(basename "$filename" .md).pdf"

mkdir -p "$target"

pandoc \
  --pdf-engine=xelatex \
  --listings \
  -f markdown \
  -t pdf \
  -V 'mainfont:New York Small' \
  -V 'monofont:Fira Code Retina' \
  -V 'geometry:margin=2.3cm' \
  -V 'papersize:a4paper' \
  -V 'linkcolor:blue' \
  -o "$target/$outputFile" "$filename" &

#pdflatex "$filename"

if ! pgrep -f "zathura $target/$outputFile"; then
    (zathura "$target"/"$outputFile") &
fi

#rm -rf "$name.aux" "$name.toc" "$name.log"
