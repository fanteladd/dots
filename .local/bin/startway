#!/bin/bash
# startup script for sway from console

[[ "$1" != "sway" && -n "$1" ]] && {
    echo "Usage: $( basename "$0" ): start a sway session from a console tty"
    exit 0
}

LOGFILE=.wsession-errors
&> /tmp/$LOGFILE
exec &> /tmp/$LOGFILE
set -x
echo "sway Starting: $( date +%F-%R )"

export XDG_SESSION_TYPE=wayland
export QT_QPA_PLATFORM="wayland;xcb"
export QT_WAYLAND_DISABLE_WINDOWDECORATION=1
export QT_AUTO_SCREEN_SCALE_FACTOR=1
export CLUTTER_BACKEND="wayland"
export MOZ_ENABLE_WAYLAND=1
export XCURSOR_SIZE=24
export XCURSOR_THEME=XCursor-Pro-Dark
export SDL_VIDEODRIVER=wayland
export LIBVA_DRIVER_NAME="iHD"
export WLR_RENDERER=vulkan
export _JAVA_AWT_WM_NONREPARENTING=1
# export __EGL_VENDOR_LIBRARY_FILENAMES=/usr/share/glvnd/egl_vendor.d/50_mesa.json
rm "$HOME/.cache/*.wob"

if [[ "$1" == "sway" ]]; then
  export XDG_CURRENT_DESKTOP=sway
  export XDG_SESSION_DESKTOP=sway
  systemctl --user stop wayland-session.target
  exec sway --unsupported-gpu
else
  export XDG_CURRENT_DESKTOP=Hyprland
  export XDG_SESSION_DESKTOP=Hyprland
  systemctl --user stop wayland-session.target
  exec Hyprland
fi
