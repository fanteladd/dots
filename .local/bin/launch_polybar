#!/bin/sh
# Script for launching polybar bars on every monitor

UID="$(id -ru)"

# Terminate already running bar instances
killall -q polybar

# Wait until the processes have been shut down
while pgrep -u "$UID" -x polybar >/dev/null; do sleep 1; done

for i in $(polybar -m | awk -F: '{print $1}'); do
    echo "$i"
    MONITOR="$i" polybar --config="$HOME/.config/polybar/config.ini" left &
    MONITOR="$i" polybar --config="$HOME/.config/polybar/config.ini" center &
    if [ ! "$i" = 'eDP-1' ]; then
        MONITOR="$i" polybar --config="$HOME/.config/polybar/config.ini" right_dock &
    else
        MONITOR="$i" polybar --config="$HOME/.config/polybar/config.ini" right &
    fi
done
